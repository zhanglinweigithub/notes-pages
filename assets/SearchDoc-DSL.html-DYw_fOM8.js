import{_ as d,a as p}from"./vZrdKAh19C-Yru1OTEc.js";import{_ as t}from"./image-20210721191544750-8RaW55Fg.js";import{_ as k,r as c,o as h,c as u,e as s,f as a,g as e,w as l,a as r}from"./app-Vg0IViah.js";const C="/notes-pages/assets/image-20230731094646632-CKI6NS2o.png",y="/notes-pages/assets/image-20210721171655308-C12HGuTG.png",E="/notes-pages/assets/image-20210721171838378-B9nU9zMA.png",m="/notes-pages/assets/image-20210721172307172-DAAwlRA3.png",v="/notes-pages/assets/image-20210721175443234-Bu53QqZn.png",b="/notes-pages/assets/image-20210721193152520-CKUaJ0ka.png",g="/notes-pages/assets/image-20210721193458182-BJC_Ezby.png",F={},q=s("h1",{id:"搜索文档-dsl",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#搜索文档-dsl"},[s("span",null,"搜索文档-DSL")])],-1),_=s("code",null,"Elasticsearch",-1),A=s("code",null,"JSON",-1),f=s("code",null,"DSL",-1),x={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html",target:"_blank",rel:"noopener noreferrer"},B=r(`<p>常见的查询类型包括：</p><ul><li><strong>查询所有</strong>：查询出所有数据，一般测试用。例如：<code>match_all</code></li><li><strong>全文检索（full text）查询</strong>：利用分词器对用户输入内容分词，然后去倒排索引库中匹配。例如： <ul><li><code>match_query</code></li><li><code>multi_match_query</code></li></ul></li><li><strong>精确查询</strong>：根据精确词条值查找数据，一般是查找<code>keyword</code>、数值、日期、<code>boolean</code>等类型字段。例如： <ul><li><code>ids</code></li><li><code>range</code></li><li><code>term</code></li></ul></li><li><strong>地理（geo）查询</strong>：根据经纬度查询。例如： <ul><li><code>geo_distance</code></li><li><code>geo_bounding_box</code></li></ul></li><li><strong>复合（compound）查询</strong>：复合查询可以将上述各种查询条件组合起来，合并查询条件。例如： <ul><li><code>bool</code></li><li><code>function_score</code></li></ul></li></ul><h2 id="一、查询全部-match-all" tabindex="-1"><a class="header-anchor" href="#一、查询全部-match-all"><span>一、查询全部 match_all</span></a></h2><ul><li>查询类型为<code>match_all</code></li><li>没有查询条件</li></ul><p>相当于<code>SQL</code>：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">SELECT</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">FROM</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> hotel</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,6),j=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库名/_search "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 固定写法")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "查询类型"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "查询条件"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"条件值"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),S=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 查询所有")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 相当于SQL：SELECT * FROM hotel")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match_all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),T=r('<figure><img src="'+C+`" alt="image-20230731094646632" tabindex="0" loading="lazy"><figcaption>image-20230731094646632</figcaption></figure><details class="hint-container details"><summary>返回结果含义</summary><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  &quot;took&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">2</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#6A9955;--shiki-dark:#6A9955;">// 查询时间</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  &quot;timed_out&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#569CD6;--shiki-dark:#569CD6;">false</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#6A9955;--shiki-dark:#6A9955;">// 是否超时</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  &quot;_shards&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;total&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">1</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;successful&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">1</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;skipped&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">0</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;failed&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">0</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  },</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  &quot;hits&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : { </span><span style="color:#6A9955;--shiki-dark:#6A9955;">// 命中得数据</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;total&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : { </span><span style="color:#6A9955;--shiki-dark:#6A9955;">// 搜索到得总条数</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">      &quot;value&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">1</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">      &quot;relation&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;eq&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;max_score&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">1.0</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#6A9955;--shiki-dark:#6A9955;">// 得分</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;hits&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : [ </span><span style="color:#6A9955;--shiki-dark:#6A9955;">// 文档</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">      {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        &quot;_index&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;hotel&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        &quot;_type&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;_doc&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        &quot;_id&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;61083&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        &quot;_score&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">1.0</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        &quot;_source&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;address&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;自由贸易试验区临港新片区南岛1号&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;brand&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;皇冠假日&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;business&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;滴水湖临港地区&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;city&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;上海&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;id&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">61083</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;location&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;30.890867, 121.937241&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;name&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;上海滴水湖皇冠假日酒店&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;pic&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;https://m.tuniucdn.com/fb3/s1/2n9c/312e971Rnj9qFyR3pPv4bTtpj1hX_w200_h200_c1_t0.jpg&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;price&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">971</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;score&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">44</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">          &quot;starName&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;五钻&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">        }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">      }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    ]</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="二、全文检索" tabindex="-1"><a class="header-anchor" href="#二、全文检索"><span>二、全文检索</span></a></h2><p>会对用户输入内容分词，== 常用于搜索框搜索 ==</p><p>全文检索查询的基本流程如下：</p><ul><li>对用户搜索的内容做分词，得到词条</li><li>根据词条去倒排索引库中匹配，得到文档<code>id</code></li><li>根据文档<code>id</code>找到文档，返回给用户</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p>因为全文检索会对用户输入的内容进行分词，只要包含其中一个词就符合条件</p><p>因为是拿着词条去匹配，因此参与搜索的字段也必须是可分词的<code>text</code>类型的字段。</p></div><ul><li><code>match</code>查询：单字段查询</li><li><code>multi_match</code>查询：多字段查询，任意一个字段符合条件就算符合查询条件</li></ul><h3 id="match" tabindex="-1"><a class="header-anchor" href="#match"><span>match</span></a></h3><p>相当于<code>SQL</code>：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">SELECT</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">FROM</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> hotel </span><span style="color:#569CD6;--shiki-dark:#569CD6;">WHERE</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> all </span><span style="color:#569CD6;--shiki-dark:#569CD6;">LIKE</span><span style="color:#CE9178;--shiki-dark:#CE9178;"> &#39;%外滩如家%&#39;</span><span style="color:#6A9955;--shiki-dark:#6A9955;"> -- 任一字段符合其中一个词即可</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,11),L=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"要搜索的内容"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),w=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"外滩如家"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),G=r(`<h3 id="mulit-match" tabindex="-1"><a class="header-anchor" href="#mulit-match"><span>mulit_match</span></a></h3><p>相当于<code>SQL</code>：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">-- 搜索的字段满足其中一个词即可</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">SELECT</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">FROM</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> hotel </span><span style="color:#569CD6;--shiki-dark:#569CD6;">WHERE</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> brand </span><span style="color:#569CD6;--shiki-dark:#569CD6;">LIKE</span><span style="color:#CE9178;--shiki-dark:#CE9178;"> &#39;%外滩如家%&#39;</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> OR</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> name</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> LIKE</span><span style="color:#CE9178;--shiki-dark:#CE9178;"> &#39;%外滩如家%&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,3),R=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "multi_match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"要搜索的内容"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "fields"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": ["),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"字段1"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"字段2"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"..."'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"字段N"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),z=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "multi_match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"外滩如家"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "fields"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": ["),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"brand"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"name"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),N=r(`<div class="hint-container tip"><p class="hint-container-title">提示</p><p>但是，搜索字段越多，对查询性能影响越大，因此建议采用<code>copy_to</code>，然后单字段查询的方式。</p></div><h2 id="三、精准查询" tabindex="-1"><a class="header-anchor" href="#三、精准查询"><span>三、精准查询</span></a></h2><p>精确查询一般是查找<code>keyword</code>、数值、日期、<code>boolean</code>等类型字段。</p><p><strong>不会</strong>对搜索条件分词。常见的有：</p><ul><li><code>term</code>：根据词条精确值查询</li><li><code>range</code>：根据值的范围查询</li></ul><h3 id="term" tabindex="-1"><a class="header-anchor" href="#term"><span>term</span></a></h3><p>因为<strong>精确查询</strong>的字段搜是不分词的字段，因此查询的条件也必须是<strong>不分词</strong>的词条。</p><p>查询时，用户输入的内容跟自动值== 完全匹配 ==时才认为符合条件。</p><p>相当于<code>SQL</code>：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">SELECT</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">FROM</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> hotel </span><span style="color:#569CD6;--shiki-dark:#569CD6;">WHERE</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> city = </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;杭州&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,10),O=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "term"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "value"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"值"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),K=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "term"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "city"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "value"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"杭州"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),M=r('<p>当我搜索的是精确词条时，能正确查询出结果：</p><figure><img src="'+y+'" alt="image-20210721171655308" tabindex="0" loading="lazy"><figcaption>image-20210721171655308</figcaption></figure><p>但是，当我搜索的内容不是词条，而是多个词语形成的短语时，反而搜索不到：</p><figure><img src="'+E+`" alt="image-20210721171838378" tabindex="0" loading="lazy"><figcaption>image-20210721171838378</figcaption></figure><h3 id="range" tabindex="-1"><a class="header-anchor" href="#range"><span>range</span></a></h3><p>范围查询，一般应用在对数值类型做范围过滤的时候</p><p>相当于SQL：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">SELECT</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">FROM</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> hotel </span><span style="color:#569CD6;--shiki-dark:#569CD6;">WHERE</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> price </span><span style="color:#569CD6;--shiki-dark:#569CD6;">BETWEEN</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;"> 100</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> AND</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;"> 2000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,8),H=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "range"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "gte"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"10"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 这里的gte代表大于等于，gt则代表大于")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "lte"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"20"),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // lte代表小于等于，lt则代表小于")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),Q=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "range"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "price"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "gte"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"100"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 这里的gte代表大于等于，gt则代表大于")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "lte"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"2000"),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // lte代表小于等于，lt则代表小于")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),V=s("figure",null,[s("img",{src:m,alt:"image-20210721172307172",tabindex:"0",loading:"lazy"}),s("figcaption",null,"image-20210721172307172")],-1),I=s("h2",{id:"四、地理坐标查询",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#四、地理坐标查询"},[s("span",null,"四、地理坐标查询")])],-1),J=s("p",null,"所谓的地理坐标查询，其实就是根据经纬度查询",-1),W={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-queries.html",target:"_blank",rel:"noopener noreferrer"},Z=r('<h3 id="矩形范围查询" tabindex="-1"><a class="header-anchor" href="#矩形范围查询"><span>矩形范围查询</span></a></h3><p>矩形范围查询，也就是<code>geo_bounding_box</code>查询，查询坐标落在某个矩形范围的所有文档：</p><figure><img src="'+p+'" alt="DKV9HZbVS6" tabindex="0" loading="lazy"><figcaption>DKV9HZbVS6</figcaption></figure><p>查询时，需要指定矩形的<strong>左上</strong>、<strong>右下</strong>两个点的坐标，然后画出一个矩形，落在该矩形内的都是符合条件的点</p>',4),U=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "geo_bounding_box"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "top_left"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 左上点")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lat"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"31.1"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lon"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"121.5")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "bottom_right"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 右下点")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lat"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"30.9"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lon"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"121.7")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),P=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "geo_bounding_box"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "location"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// location为文档中存在的字段")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "top_left"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 左上点")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lat"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"31.1"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lon"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"121.5")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "bottom_right"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 右下点")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lat"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"30.9"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "lon"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"121.7")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),X=s("h3",{id:"附近查询",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#附近查询"},[s("span",null,"附近查询")])],-1),$=s("p",null,"附近查询，也叫做距离查询（geo_distance）：查询到指定中心点小于某个距离值的所有文档。",-1),Y=s("p",null,"换句话来说，在地图上找一个点作为圆心，以指定距离为半径，画一个圆，落在圆内的坐标都算符合条件：",-1),ss=s("figure",null,[s("img",{src:d,alt:"vZrdKAh19C",tabindex:"0",loading:"lazy"}),s("figcaption",null,"vZrdKAh19C")],-1),as=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "geo_distance"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "distance"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"15km"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 半径")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"31.21,121.5"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 圆心")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),ls=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "geo_distance"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "distance"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"15km"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 半径")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "location"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"31.21, 121.5"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 圆心 location为文档中存在的字段")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),is=r('<figure><img src="'+v+`" alt="image-20210721175443234" tabindex="0" loading="lazy"><figcaption>image-20210721175443234</figcaption></figure><h2 id="五、复合查询" tabindex="-1"><a class="header-anchor" href="#五、复合查询"><span>五、复合查询</span></a></h2><p>复合（compound）查询：复合查询可以将其它简单查询组合起来，实现更复杂的搜索逻辑。常见的有两种：</p><ul><li><code>fuction score</code>：算分函数查询，可以控制文档相关性算分，控制文档排名</li><li><code>bool query</code>：布尔查询，利用逻辑关系组合多个其它的查询，实现复杂搜索</li></ul><h3 id="相关性算分" tabindex="-1"><a class="header-anchor" href="#相关性算分"><span>相关性算分</span></a></h3><p>当我们利用<code>match</code>查询时，文档结果会根据与搜索词条的关联度打分（<code>_score</code>），返回结果时按照分值降序排列。</p><p>例如，我们搜索 &quot;虹桥如家&quot;，结果如下：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">[</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;_score&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">17.850193</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;_source&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">      &quot;name&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;虹桥如家酒店真不错&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  },</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;_score&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">12.259849</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;_source&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">      &quot;name&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;外滩如家酒店真不错&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  },</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;_score&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">11.91091</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;_source&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">      &quot;name&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> : </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;迪士尼如家酒店真不错&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">  }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="算分函数查询-function-score" tabindex="-1"><a class="header-anchor" href="#算分函数查询-function-score"><span>算分函数查询 Function Score</span></a></h3><ul><li><p>使用<code>function score query</code>，可以修改文档的相关性算分(query score)，根据新得到的算分排序。</p></li><li><p>以百度为例，你搜索的结果中，并不是相关度越高排名越靠前，而是谁掏的钱多排名就越靠前。</p></li><li><p>要想人为控制相关性算分，就需要利用<code>elasticsearch</code>中的<code>function score</code> 查询了。</p></li></ul>`,10),ns=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'   "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'       "function_score"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'           "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'"match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'"all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"外滩"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"} },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'           "functions"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"               {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                   "filter"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {"),s("span",{style:{color:"#F44747","--shiki-dark":"#F44747"}},"过滤条件"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"},")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                   "算分函数"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#F44747","--shiki-dark":"#F44747"}},"值")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"               }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"           ],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'           "运算模式"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"multiply"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"       }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"   } ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),es=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 给“如家”这个品牌的酒店排名靠前一些")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// - 原始条件：不确定，可以任意变化")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},'// - 过滤条件：`brand = "如家"`')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// - 算分函数：可以简单粗暴，直接给固定的算分结果，`weight`")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// - 运算模式：比如求和")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "function_score"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'            "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 原始查询，可以是任意条件")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                "match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                    "all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"外滩"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"            },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'            "functions"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [ "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 算分函数")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                    "filter"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 满足的条件，品牌必须是如家")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                        "term"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                            "brand"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"如家"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                        }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                    },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                    "weight"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"2"),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 算分权重为2")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"            ],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'            "boost_mode"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"sum"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 加权模式，求和")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),Ds=r('<p><code>function score</code> 查询中包含四部分内容：</p><ul><li><strong>原始查询</strong>条件：<code>query</code>部分，基于这个条件搜索文档，并且基于<code>BM25</code>算法给文档打分，<strong>原始算分</strong>（query score)</li><li><strong>过滤条件</strong>：<code>filter</code>部分，符合该条件的文档才会重新算分</li><li><strong>算分函数</strong>：符合<code>filter</code>条件的文档要根据这个函数做运算，得到的<strong>函数算分</strong>（function score），有四种函数 <ul><li><code>weight</code>：函数结果是常量</li><li><code>field_value_factor</code>：以文档中的某个字段值作为函数结果</li><li><code>random_score</code>：以随机数作为函数结果</li><li><code>script_score</code>：自定义算分函数算法</li></ul></li><li><strong>运算模式</strong>：算分函数的结果、原始查询的相关性算分，两者之间的运算方式，包括： <ul><li><code>multiply</code>：相乘</li><li><code>replace</code>：用<code>function score</code>替换<code>query score</code></li><li>其它，例如：<code>sum、avg、max、min</code></li></ul></li></ul><p><code>function score</code>的运行流程如下：</p><ul><li>1）根据<strong>原始条件</strong>查询搜索文档，并且计算相关性算分，称为<strong>原始算分</strong>（query score）</li><li>2）根据<strong>过滤条件</strong>，过滤文档</li><li>3）符合<strong>过滤条件</strong>的文档，基于<strong>算分函数</strong>运算，得到<strong>函数算分</strong>（function score）</li><li>4）将<strong>原始算分</strong>（query score）和<strong>函数算分</strong>（function score）基于<strong>运算模式</strong>做运算，得到最终结果，作为相关性算分。</li></ul><p>因此，其中的关键点是：</p><ul><li>过滤条件：决定哪些文档的算分被修改</li><li>算分函数：决定函数算分的算法</li><li>运算模式：决定最终算分结果</li></ul><figure><img src="'+t+'" alt="image-20210721191544750" tabindex="0" loading="lazy"><figcaption>image-20210721191544750</figcaption></figure><p>测试，在未添加算分函数时，如家得分如下：</p><figure><img src="'+b+'" alt="image-20210721193152520" tabindex="0" loading="lazy"><figcaption>image-20210721193152520</figcaption></figure><p>添加了算分函数后，如家得分就提升了：</p><figure><img src="'+g+`" alt="image-20210721193458182" tabindex="0" loading="lazy"><figcaption>image-20210721193458182</figcaption></figure><h3 id="布尔查询" tabindex="-1"><a class="header-anchor" href="#布尔查询"><span>布尔查询</span></a></h3><p>布尔查询是一个或多个查询子句的组合，每一个子句就是一个<strong>子查询</strong>。子查询的组合方式有：</p><ul><li><code>must</code>：必须匹配每个子查询，类似“与”</li><li><code>should</code>：选择性匹配子查询，类似“或”</li><li><code>must_not</code>：必须不匹配，<strong>不参与算分</strong>，类似“非”</li><li><code>filter</code>：必须匹配，<strong>不参与算分</strong></li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><ol><li><p>参与打分的字段越多，查询的性能也越差</p></li><li><p>多条件查询时，建议这样做：</p><ul><li><p>搜索框的关键字搜索，是全文检索查询，使用<code>must</code>查询，参与算分</p></li><li><p>其它过滤条件，采用<code>filter</code>查询。不参与算分</p></li></ul></li></ol></div><p>相当于SQL：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">SELECT</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">FROM</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> hotel </span><span style="color:#569CD6;--shiki-dark:#569CD6;">WHERE</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> city = </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;上海&#39;</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> AND</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> (brand = </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;皇冠假日&#39;</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> OR</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> brand = </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;华美达&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) </span><span style="color:#569CD6;--shiki-dark:#569CD6;">AND</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> price &gt; </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">500</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> AND</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> score &gt;= </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">45</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">GET /hotel/_search</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    &quot;query&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        &quot;bool&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">            &quot;must&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: [</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                    &quot;term&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                        &quot;city&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;上海&quot;</span><span style="color:#6A9955;--shiki-dark:#6A9955;"> // 城市必须为上海</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">            ],</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">            &quot;should&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: [</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                    &quot;term&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                        &quot;brand&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;皇冠假日&quot;</span><span style="color:#6A9955;--shiki-dark:#6A9955;"> // 品牌为 皇冠假日或华美达</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                },</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                    &quot;term&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                        &quot;brand&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;华美达&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">            ],</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">            &quot;must_not&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: [</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                    &quot;range&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                        &quot;price&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                            &quot;lte&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">500</span><span style="color:#6A9955;--shiki-dark:#6A9955;"> // 价格不低于/等于500 也就是要大于500</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                        }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">            ],</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">            &quot;filter&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: [</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                    &quot;range&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                        &quot;score&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                            &quot;gte&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">: </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">45</span><span style="color:#6A9955;--shiki-dark:#6A9955;"> // 评分大于等于45</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                        }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">            ]</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">        }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,18);function rs(os,cs){const o=c("ExternalLinkIcon"),D=c("CodeTabs");return h(),u("div",null,[q,s("p",null,[_,a("提供了基于"),A,a("的"),f,a("（"),s("a",x,[a("Domain Specific Languageopen in new window"),e(o)]),a("）来定义查询。")]),B,e(D,{id:"108",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[j]),tab1:l(({value:i,isActive:n})=>[S]),_:1}),T,e(D,{id:"175",data:[{id:"match语法"},{id:"match示例"}]},{title0:l(({value:i,isActive:n})=>[a("match语法")]),title1:l(({value:i,isActive:n})=>[a("match示例")]),tab0:l(({value:i,isActive:n})=>[L]),tab1:l(({value:i,isActive:n})=>[w]),_:1}),G,e(D,{id:"190",data:[{id:"mulit_match语法"},{id:"mulit_match示例"}]},{title0:l(({value:i,isActive:n})=>[a("mulit_match语法")]),title1:l(({value:i,isActive:n})=>[a("mulit_match示例")]),tab0:l(({value:i,isActive:n})=>[R]),tab1:l(({value:i,isActive:n})=>[z]),_:1}),N,e(D,{id:"237",data:[{id:"term语法"},{id:"term示例"}]},{title0:l(({value:i,isActive:n})=>[a("term语法")]),title1:l(({value:i,isActive:n})=>[a("term示例")]),tab0:l(({value:i,isActive:n})=>[O]),tab1:l(({value:i,isActive:n})=>[K]),_:1}),M,e(D,{id:"267",data:[{id:"range语法"},{id:"range示例"}]},{title0:l(({value:i,isActive:n})=>[a("range语法")]),title1:l(({value:i,isActive:n})=>[a("range示例")]),tab0:l(({value:i,isActive:n})=>[H]),tab1:l(({value:i,isActive:n})=>[Q]),_:1}),V,I,J,s("p",null,[a("官方文档："),s("a",W,[a("https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-queries.html"),e(o)])]),Z,e(D,{id:"299",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[U]),tab1:l(({value:i,isActive:n})=>[P]),_:1}),X,$,Y,ss,e(D,{id:"319",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[as]),tab1:l(({value:i,isActive:n})=>[ls]),_:1}),is,e(D,{id:"378",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[ns]),tab1:l(({value:i,isActive:n})=>[es]),_:1}),Ds])}const ks=k(F,[["render",rs],["__file","SearchDoc-DSL.html.vue"]]),hs=JSON.parse('{"path":"/Use/Java/ElasticSearch/SearchDoc-DSL.html","title":"搜索文档-DSL","lang":"zh-CN","frontmatter":{"order":6,"category":"使用篇"},"headers":[{"level":2,"title":"一、查询全部 match_all","slug":"一、查询全部-match-all","link":"#一、查询全部-match-all","children":[]},{"level":2,"title":"二、全文检索","slug":"二、全文检索","link":"#二、全文检索","children":[{"level":3,"title":"match","slug":"match","link":"#match","children":[]},{"level":3,"title":"mulit_match","slug":"mulit-match","link":"#mulit-match","children":[]}]},{"level":2,"title":"三、精准查询","slug":"三、精准查询","link":"#三、精准查询","children":[{"level":3,"title":"term","slug":"term","link":"#term","children":[]},{"level":3,"title":"range","slug":"range","link":"#range","children":[]}]},{"level":2,"title":"四、地理坐标查询","slug":"四、地理坐标查询","link":"#四、地理坐标查询","children":[{"level":3,"title":"矩形范围查询","slug":"矩形范围查询","link":"#矩形范围查询","children":[]},{"level":3,"title":"附近查询","slug":"附近查询","link":"#附近查询","children":[]}]},{"level":2,"title":"五、复合查询","slug":"五、复合查询","link":"#五、复合查询","children":[{"level":3,"title":"相关性算分","slug":"相关性算分","link":"#相关性算分","children":[]},{"level":3,"title":"算分函数查询 Function Score","slug":"算分函数查询-function-score","link":"#算分函数查询-function-score","children":[]},{"level":3,"title":"布尔查询","slug":"布尔查询","link":"#布尔查询","children":[]}]}],"git":{"createdTime":1708330205000,"updatedTime":1708873062000,"contributors":[{"name":"zhanglinwei","email":"3498729975@qq.com","commits":2}]},"readingTime":{"minutes":8.67,"words":2600},"filePathRelative":"Use/Java/ElasticSearch/SearchDoc-DSL.md","localizedDate":"2024年2月19日"}');export{ks as comp,hs as data};
