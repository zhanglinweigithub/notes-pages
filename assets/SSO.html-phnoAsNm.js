import{_ as e,o as a,c as s,a as i}from"./app-Vg0IViah.js";const n="/notes-pages/assets/image-20240205204526333-CJyykpb0.png",t="/notes-pages/assets/image-20240205205356476-7gUbt0Oi.png",l="/notes-pages/assets/image-20240205205720227-CCI5y90F.png",c={},r=i('<h1 id="sso单点登录方案-基于session、cookie" tabindex="-1"><a class="header-anchor" href="#sso单点登录方案-基于session、cookie"><span>SSO单点登录方案（基于Session、Cookie）</span></a></h1><h2 id="一、sso-single-sign-on" tabindex="-1"><a class="header-anchor" href="#一、sso-single-sign-on"><span>一、SSO（Single Sign-On）</span></a></h2><p>是一种允许多个应用程序和服务之间共享用户认证的机制。</p><p>具体来说，单点登录使得用户只需在一次登录过程中，就能访问所有相互信任的应用程序和服务，无需在不同系统间重复登录。</p><h2 id="二、交互流程" tabindex="-1"><a class="header-anchor" href="#二、交互流程"><span>二、交互流程</span></a></h2><h3 id="_1、登录" tabindex="-1"><a class="header-anchor" href="#_1、登录"><span>1、登录</span></a></h3><figure><img src="'+n+'" alt="image-20240205204526333" tabindex="0" loading="lazy"><figcaption>image-20240205204526333</figcaption></figure><p>1，用户访问IRS子系统时，检测子系统是否是已登录，如未登录，则跳转到IRS统一用户中心登录页面（携带系统标识，如需要登录后回调到指定地址，则在增加callbackUrl参数传入指定页面url）（对应流程图1，2，3）</p><p>2，统一用户中心判断统一用户中心是否已经登录过，如未登录，则跳转到认证页面（扫码/账号密码登录）（对应流程图4）</p><p>3，用户在统一用户中心登录页面完登录，统一用户中心签发ticket,并写道ticket跳转IRS子系统提供的回调地址（对应流程图5.6）</p><p>4，IRS子系统拿到ticket，并通过ticket向统一用户中心换取用户令牌。（对应流程图7，8，9）</p><p>5，IRS子系统拿到用户令牌后，通过令牌向统一用户中心请求用户详情（包括用户信息，组织信息，用户角色，权限等)(对应流程图10，11）</p><p>6，IRS子系统拿到用户详情后，完成子系统登录，并返回指定页面</p><h3 id="_2、登出" tabindex="-1"><a class="header-anchor" href="#_2、登出"><span>2、登出</span></a></h3><figure><img src="'+t+'" alt="image-20240205205356476" tabindex="0" loading="lazy"><figcaption>image-20240205205356476</figcaption></figure><p>1，用户发起登出请求，前端调用IRS子系统登出接口，IRS子系统完成登出(对应流程图1，2）</p><p>2，浏览器跳转统一用户中心登出页面（对应流程图3）</p><p>3，统一用户中心收到登出请求，拿到当前登录用令牌，并向已登录过的IRS子系统广播登出通知（对应流程图4，5）</p><p>4，统一用户用中心完成登出，返回登录页面（对应流程图6）</p><h3 id="_3、令牌延期" tabindex="-1"><a class="header-anchor" href="#_3、令牌延期"><span>3、令牌延期</span></a></h3><p>令牌延期功能主要为了解决IRS子系统与统一用户中心session过期时间不一致时导致的IRS子系统未登出，但IRS用户中心已经登出的问题。</p><figure><img src="'+l+'" alt="image-20240205205720227" tabindex="0" loading="lazy"><figcaption>image-20240205205720227</figcaption></figure><p>实现逻辑主要时IRS子系统接口调用时，定期向IRS统一用户中心发送令牌延期的请求，刷新统一用户中心会话过期时间。</p><h2 id="三、接入准备" tabindex="-1"><a class="header-anchor" href="#三、接入准备"><span>三、接入准备</span></a></h2><h3 id="_1、申请accesskey-secretkey" tabindex="-1"><a class="header-anchor" href="#_1、申请accesskey-secretkey"><span>1、申请accessKey/secretKey</span></a></h3><p>向统一用户中心申请<code>accessKey/secretKey</code>，主要用于和用户中心接口交互签名校验，以及标识系统来源。</p><h3 id="_2、提供登录、登出回调" tabindex="-1"><a class="header-anchor" href="#_2、提供登录、登出回调"><span>2、提供登录、登出回调</span></a></h3><p><strong>1）登录回调</strong></p><p>系统登录回调地址用于在单点登录对接中，统一用户中心登录后，签发<code>ticket</code>回调系统登录地址（对应2.1单点登录流程图中流程6）</p><p><strong>例：</strong> <code>http://{{应用子系统提供的登录地址}}?service={{系统标识}}&amp;ticket={{签发的ticket}}</code></p><p><strong>2）登出回调</strong></p><p>系统登出回调地址用于在单点登出对接中，统一用户中心登出后，携带<code>userToken</code>回调已登录过的各子系统登出地址（对应2.2单点登录流程图中流程4）</p><p><strong>例：</strong> <code>http://{{应用子系统提供的登出地址}}?service={{系统标识}}&amp;userToken={{用户令牌}}</code></p><h2 id="四、对接接口" tabindex="-1"><a class="header-anchor" href="#四、对接接口"><span>四、对接接口</span></a></h2><h3 id="_1、登录接口" tabindex="-1"><a class="header-anchor" href="#_1、登录接口"><span>1、登录接口</span></a></h3><h3 id="_2、通过ticket获取用户令牌接口" tabindex="-1"><a class="header-anchor" href="#_2、通过ticket获取用户令牌接口"><span>2、通过ticket获取用户令牌接口</span></a></h3><h3 id="_3、通过用户令牌获取用户详情接口" tabindex="-1"><a class="header-anchor" href="#_3、通过用户令牌获取用户详情接口"><span>3、通过用户令牌获取用户详情接口</span></a></h3><h3 id="_4、令牌延期接口" tabindex="-1"><a class="header-anchor" href="#_4、令牌延期接口"><span>4、令牌延期接口</span></a></h3><h3 id="_5、登出接口" tabindex="-1"><a class="header-anchor" href="#_5、登出接口"><span>5、登出接口</span></a></h3><h2 id="五、代码实现" tabindex="-1"><a class="header-anchor" href="#五、代码实现"><span>五、代码实现</span></a></h2><h3 id="_1、统一用户中心" tabindex="-1"><a class="header-anchor" href="#_1、统一用户中心"><span>1、统一用户中心</span></a></h3><h3 id="_2、各子系统" tabindex="-1"><a class="header-anchor" href="#_2、各子系统"><span>2、各子系统</span></a></h3>',42),h=[r];function o(p,d){return a(),s("div",null,h)}const _=e(c,[["render",o],["__file","SSO.html.vue"]]),k=JSON.parse('{"path":"/Use/Java/Shiro/SSO.html","title":"SSO单点登录方案（基于Session、Cookie）","lang":"zh-CN","frontmatter":{"category":"使用篇","feed":false,"seo":false},"headers":[{"level":2,"title":"一、SSO（Single Sign-On）","slug":"一、sso-single-sign-on","link":"#一、sso-single-sign-on","children":[]},{"level":2,"title":"二、交互流程","slug":"二、交互流程","link":"#二、交互流程","children":[{"level":3,"title":"1、登录","slug":"_1、登录","link":"#_1、登录","children":[]},{"level":3,"title":"2、登出","slug":"_2、登出","link":"#_2、登出","children":[]},{"level":3,"title":"3、令牌延期","slug":"_3、令牌延期","link":"#_3、令牌延期","children":[]}]},{"level":2,"title":"三、接入准备","slug":"三、接入准备","link":"#三、接入准备","children":[{"level":3,"title":"1、申请accessKey/secretKey","slug":"_1、申请accesskey-secretkey","link":"#_1、申请accesskey-secretkey","children":[]},{"level":3,"title":"2、提供登录、登出回调","slug":"_2、提供登录、登出回调","link":"#_2、提供登录、登出回调","children":[]}]},{"level":2,"title":"四、对接接口","slug":"四、对接接口","link":"#四、对接接口","children":[{"level":3,"title":"1、登录接口","slug":"_1、登录接口","link":"#_1、登录接口","children":[]},{"level":3,"title":"2、通过ticket获取用户令牌接口","slug":"_2、通过ticket获取用户令牌接口","link":"#_2、通过ticket获取用户令牌接口","children":[]},{"level":3,"title":"3、通过用户令牌获取用户详情接口","slug":"_3、通过用户令牌获取用户详情接口","link":"#_3、通过用户令牌获取用户详情接口","children":[]},{"level":3,"title":"4、令牌延期接口","slug":"_4、令牌延期接口","link":"#_4、令牌延期接口","children":[]},{"level":3,"title":"5、登出接口","slug":"_5、登出接口","link":"#_5、登出接口","children":[]}]},{"level":2,"title":"五、代码实现","slug":"五、代码实现","link":"#五、代码实现","children":[{"level":3,"title":"1、统一用户中心","slug":"_1、统一用户中心","link":"#_1、统一用户中心","children":[]},{"level":3,"title":"2、各子系统","slug":"_2、各子系统","link":"#_2、各子系统","children":[]}]}],"git":{"createdTime":1708330205000,"updatedTime":1708873062000,"contributors":[{"name":"zhanglinwei","email":"3498729975@qq.com","commits":2}]},"readingTime":{"minutes":3.13,"words":938},"filePathRelative":"Use/Java/Shiro/SSO.md","localizedDate":"2024年2月19日"}');export{_ as comp,k as data};
