import{_ as r,r as o,o as p,c,g as k,w as n,a as D,f as a,e as s}from"./app-Vg0IViah.js";const d={},t=D(`<h1 id="监听器" tabindex="-1"><a class="header-anchor" href="#监听器"><span>监听器</span></a></h1><ol><li>自定义事件</li><li>发布事件</li><li>自定义监听器</li></ol><h2 id="一、自定义监听器" tabindex="-1"><a class="header-anchor" href="#一、自定义监听器"><span>一、自定义监听器</span></a></h2><h3 id="_1、自定义事件" tabindex="-1"><a class="header-anchor" href="#_1、自定义事件"><span>1、自定义事件</span></a></h3><p>需要继承 <code>ApplicationEvent</code> 对象，在事件中定义一个 <code>User</code> 对象来模拟数据，构造方法中将 <code>User</code> 对象传进来初始化</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">/**</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> * 自定义事件</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> */</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Data</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">public</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> class</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> MyEvent</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> extends</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> ApplicationEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> User</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> MyEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Object</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> source</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">User</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">        super</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(source);</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">        this</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = user;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、发布事件" tabindex="-1"><a class="header-anchor" href="#_2、发布事件"><span>2、发布事件</span></a></h3><p>注入 <code>ApplicationContext</code>，在业务代码处理完之后，通过 <code>ApplicationContext</code> 对象手动发布 <code>MyEvent</code> 事件</p><p>这样我们自定义的监听器就能监听到</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">/**</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> * UserService</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> */</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Service</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">public</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> class</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> UserService</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Resource</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> ApplicationContext</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> applicationContext</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">    /**</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     * 发布事件</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">@return</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     */</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> User</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> getUser2</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">() {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        User</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> User</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">1L</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;zhanglinwei&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;123456&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">		// 发布事件</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        MyEvent</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> event</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> MyEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#569CD6;--shiki-dark:#569CD6;">this</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, user);</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        applicationContext</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">publishEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(event);</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> user;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、自定义监听器" tabindex="-1"><a class="header-anchor" href="#_3、自定义监听器"><span>3、自定义监听器</span></a></h3><ul><li><p>自定义一个监听器来监听上面定义的 <code>MyEvent</code> 事件</p></li><li><p>自定义监听器需要实现 <code>ApplicationListener</code> 接口</p></li><li><p>然后重写 <code>onApplicationEvent</code> 方法，将自定义的 <code>MyEvent</code> 事件传进来</p></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">/**</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> * 自定义监听器，监听MyEvent事件</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> */</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Component</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">public</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> class</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> MyEventListener</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> implements</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> ApplicationListener</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">MyEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">&gt; {</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Override</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> void</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> onApplicationEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">MyEvent</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> myEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">		// 把事件中的信息获取到</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        User</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">myEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getUser</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">		// 处理事件，实际项目中可以通知别的微服务或者处理其他逻辑等等</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        System</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">out</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">println</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;用户名：&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> + </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getUsername</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">());</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        System</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">out</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">println</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;密码：&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> + </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getPassword</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">());</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、使用guava包" tabindex="-1"><a class="header-anchor" href="#二、使用guava包"><span>二、使用guava包</span></a></h2><h3 id="_1、依赖" tabindex="-1"><a class="header-anchor" href="#_1、依赖"><span>1、依赖</span></a></h3><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#808080;--shiki-dark:#808080;">&lt;</span><span style="color:#569CD6;--shiki-dark:#569CD6;">dependency</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;--shiki-dark:#808080;">	&lt;</span><span style="color:#569CD6;--shiki-dark:#569CD6;">groupId</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">com.google.guava</span><span style="color:#808080;--shiki-dark:#808080;">&lt;/</span><span style="color:#569CD6;--shiki-dark:#569CD6;">groupId</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;--shiki-dark:#808080;">	&lt;</span><span style="color:#569CD6;--shiki-dark:#569CD6;">artifactId</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">guava</span><span style="color:#808080;--shiki-dark:#808080;">&lt;/</span><span style="color:#569CD6;--shiki-dark:#569CD6;">artifactId</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;--shiki-dark:#808080;">	&lt;</span><span style="color:#569CD6;--shiki-dark:#569CD6;">version</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">29.0-jre</span><span style="color:#808080;--shiki-dark:#808080;">&lt;/</span><span style="color:#569CD6;--shiki-dark:#569CD6;">version</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;--shiki-dark:#808080;">&lt;/</span><span style="color:#569CD6;--shiki-dark:#569CD6;">dependency</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、配置类" tabindex="-1"><a class="header-anchor" href="#_2、配置类"><span>2、配置类</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> com.google.common.eventbus.AsyncEventBus;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> com.google.common.eventbus.EventBus;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.context.annotation.Bean;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.context.annotation.Configuration;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.scheduling.concurrent.ThreadPoolExecutorFactoryBean;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> java.util.concurrent.Executor;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">/**</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">@author</span><span style="color:#6A9955;--shiki-dark:#6A9955;"> gaoll</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> * @time 2021/7/7 14:30</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;"> **/</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Configuration</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">public</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> class</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> EventBusConfig</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Bean</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> Executor</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> executor</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">() {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        ThreadPoolExecutorFactoryBean</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> ThreadPoolExecutorFactoryBean</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">setCorePoolSize</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">5</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">setMaxPoolSize</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">10</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">setKeepAliveSeconds</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">100</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">setQueueCapacity</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">100</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">setThreadNamePrefix</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;event-bus-&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">initialize</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> factory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getObject</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">    /**</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     * 定义事件</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">@return</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     */</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Bean</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;customEvent&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> EventBus</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> customEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(){</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> getAsyncEventBus</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> AsyncEventBus</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> getAsyncEventBus</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">() {</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#C586C0;--shiki-dark:#C586C0;"> new</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> AsyncEventBus</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">executor</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">());</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、发布事件" tabindex="-1"><a class="header-anchor" href="#_3、发布事件"><span>3、发布事件</span></a></h3>`,19),C=s("div",{class:"language-java line-numbers-mode","data-ext":"java","data-title":"java"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"@"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Service")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"public"),s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}}," class"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," CustomServiceImpl"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," {")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    @"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Resource"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(name = "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"customEvent"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    private"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," EventBus"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," customEvent"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},";")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    @"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Autowired")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    private"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," MessageSender"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," messageSender"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},";")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    public"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," void"),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}}," publishEvent"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Object"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," obj"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"        // do something")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"        messageSender"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"send"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(customEvent, obj);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),h=s("div",{class:"language-java line-numbers-mode","data-ext":"java","data-title":"java"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"import"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," com.google.common.eventbus.EventBus;")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"import"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," com.google.gson.Gson;")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"@"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Service")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"@"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Slf4j")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"public"),s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}}," class"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," MessageSender"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," {")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    @"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Autowired")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    private"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," ApplicationContext"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," applicationContext"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},";")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    public"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," void"),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}}," send"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Object"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," topic"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},","),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Object"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," object"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"){")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"        TxMessage"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," = "),s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"new"),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}}," TxMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"();")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"        txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"setData"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(object);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"        txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"setTarget"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(topic);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"        if"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"TransactionSynchronizationManager"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"getCurrentTransactionName"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"()!="),s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"null"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"){")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"            applicationContext"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"publishEvent"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(txMessage);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }"),s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"else"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"            //不存在事务")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"            txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"setInTransaction"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"false"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"            doSend"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(txMessage);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    @"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"TransactionalEventListener"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(phase = "),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"TransactionPhase"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"AFTER_COMMIT"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",classes = {"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"TxMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"class"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"})")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"    void"),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}}," doSend"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"TxMessage"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"){")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"        if"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"getTarget"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"() "),s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"instanceof"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," EventBus){")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"            ((EventBus)"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"getTarget"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"())."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"post"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"getData"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"());")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }"),s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"else"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"            try"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"                log"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"info"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"receive msg,target={},data={}"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},","),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"getTarget"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(),"),s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"new"),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}}," Gson"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"()."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"toJson"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"getData"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"()));")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"            }"),s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"catch"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," ("),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Exception"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," e"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"){")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"                if"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(!"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"txMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"isInTransaction"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"()){")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"                    throw"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," e;")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},"                log"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"error"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"("),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"transaction message occur error,message={}"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},","),s("span",{style:{color:"#C586C0","--shiki-dark":"#C586C0"}},"new"),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}}," Gson"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"()."),s("span",{style:{color:"#DCDCAA","--shiki-dark":"#DCDCAA"}},"toJson"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"(txMessage));")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"            }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"            //实际调用")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),y=s("div",{class:"language-java line-numbers-mode","data-ext":"java","data-title":"java"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"@"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}},"Data")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"public"),s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}}," class"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," TxMessage"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"    /**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"     * 数据内容")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"     */")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    private"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," Object"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," data"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},";")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"    /**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"     * 判断是否存在事务")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"     */")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    private"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," boolean"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," inTransaction"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},";")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"    /**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"     * 1.如果是EventBus,target=事件发布源")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"     * 2.如果是消息中间件,target=topic")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"     */")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#569CD6","--shiki-dark":"#569CD6"}},"    private"),s("span",{style:{color:"#4EC9B0","--shiki-dark":"#4EC9B0"}}," Object"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}}," target"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},";")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),v=D(`<h3 id="_4、事件监听器" tabindex="-1"><a class="header-anchor" href="#_4、事件监听器"><span>4、事件监听器</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Component</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Slf4j</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">public</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> class</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> CustomEventListener</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Autowired</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Qualifier</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;customEvent&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> EventBus</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> customEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">PostConstruct</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> void</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> init</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">() {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">        customEvent</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">register</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#569CD6;--shiki-dark:#569CD6;">this</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Subscribe</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">AllowConcurrentEvents</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> void</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> process</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Object</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> msg</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">        // do something</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function u(E,A){const e=o("CodeTabs");return p(),c("div",null,[t,k(e,{id:"75",data:[{id:"ServiceImpl"},{id:"MessageSender"},{id:"TxMessage"}]},{title0:n(({value:i,isActive:l})=>[a("ServiceImpl")]),title1:n(({value:i,isActive:l})=>[a("MessageSender")]),title2:n(({value:i,isActive:l})=>[a("TxMessage")]),tab0:n(({value:i,isActive:l})=>[C]),tab1:n(({value:i,isActive:l})=>[h]),tab2:n(({value:i,isActive:l})=>[y]),_:1}),v])}const b=r(d,[["render",u],["__file","Listener.html.vue"]]),B=JSON.parse('{"path":"/Use/Java/SpringBoot/Listener.html","title":"监听器","lang":"zh-CN","frontmatter":{"category":"使用篇"},"headers":[{"level":2,"title":"一、自定义监听器","slug":"一、自定义监听器","link":"#一、自定义监听器","children":[{"level":3,"title":"1、自定义事件","slug":"_1、自定义事件","link":"#_1、自定义事件","children":[]},{"level":3,"title":"2、发布事件","slug":"_2、发布事件","link":"#_2、发布事件","children":[]},{"level":3,"title":"3、自定义监听器","slug":"_3、自定义监听器","link":"#_3、自定义监听器","children":[]}]},{"level":2,"title":"二、使用guava包","slug":"二、使用guava包","link":"#二、使用guava包","children":[{"level":3,"title":"1、依赖","slug":"_1、依赖","link":"#_1、依赖","children":[]},{"level":3,"title":"2、配置类","slug":"_2、配置类","link":"#_2、配置类","children":[]},{"level":3,"title":"3、发布事件","slug":"_3、发布事件","link":"#_3、发布事件","children":[]},{"level":3,"title":"4、事件监听器","slug":"_4、事件监听器","link":"#_4、事件监听器","children":[]}]}],"git":{"createdTime":1708330205000,"updatedTime":1708873062000,"contributors":[{"name":"zhanglinwei","email":"3498729975@qq.com","commits":2}]},"readingTime":{"minutes":2.15,"words":645},"filePathRelative":"Use/Java/SpringBoot/Listener.md","localizedDate":"2024年2月19日"}');export{b as comp,B as data};
