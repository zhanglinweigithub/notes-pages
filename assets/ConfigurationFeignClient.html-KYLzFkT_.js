import{_ as s,o as a,c as n,a as i}from"./app-Vg0IViah.js";const D={},l=i(`<h1 id="一、配置feignclient" tabindex="-1"><a class="header-anchor" href="#一、配置feignclient"><span>一、配置FeignClient</span></a></h1><p>1、方式一</p><h3 id="_2、方式二" tabindex="-1"><a class="header-anchor" href="#_2、方式二"><span>2、方式二</span></a></h3><p>该方式为上游业务（服务提供方）提供了一个stater包，内部是对外提供的一些接口，我们直接将这些接口注入Spring即可使用，避免了自己手写Client接口</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> cn.hutool.core.exceptions.ExceptionUtil;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> feign.*;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> feign.codec.Decoder;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> feign.codec.Encoder;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> feign.slf4j.Slf4jLogger;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> lombok.Data;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> lombok.extern.slf4j.Slf4j;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.apache.http.conn.ssl.NoopHostnameVerifier;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.apache.http.ssl.SSLContextBuilder;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.boot.context.properties.ConfigurationProperties;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.cloud.openfeign.FeignClientsConfiguration;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.context.annotation.Bean;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.context.annotation.Configuration;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> org.springframework.context.annotation.Import;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> javax.net.ssl.SSLContext;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> java.util.Map;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> java.util.concurrent.TimeUnit;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Data</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Configuration</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Import</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">FeignClientsConfiguration</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">class</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">ConfigurationProperties</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;feign&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Slf4j</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">public</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> class</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> FeignClientConfig</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> String</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> userClientHost</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> String</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> appKey</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> String</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> appSecret</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Bean</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> UserClient</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> userClient</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Contract</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> contract</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Decoder</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> decoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Encoder</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> encoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> buildFeignBuilder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(contract, decoder, encoder).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">target</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">UserClient</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">class</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, userClientHost);</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Bean</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> OrgClient</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> orgClient</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Contract</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> contract</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Decoder</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> decoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Encoder</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> encoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> buildFeignBuilder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(contract, decoder, encoder).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">target</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">OrgClient</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">class</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, userClientHost);</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> Feign</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Builder</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> buildFeignBuilder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Contract</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> contract</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Decoder</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> decoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Encoder</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> encoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        Client</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> client</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        try</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">            SSLContext</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> context</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> SSLContextBuilder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                    .</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">loadTrustMaterial</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#569CD6;--shiki-dark:#569CD6;">null</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, (chain, authType) </span><span style="color:#569CD6;--shiki-dark:#569CD6;">-&gt;</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">                    .</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">build</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">            client = </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> Client.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">Default</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">context</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getSocketFactory</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(), </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> NoopHostnameVerifier</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">());</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">        } </span><span style="color:#C586C0;--shiki-dark:#C586C0;">catch</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> (</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Exception</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> e</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">            log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">error</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&quot;Create feign client whit SSL config failed {}&quot;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">ExceptionUtil</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">stacktraceToString</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(e));</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">            client = </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> Client.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">Default</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#569CD6;--shiki-dark:#569CD6;">null</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#569CD6;--shiki-dark:#569CD6;">null</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">        }</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        Request</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Options</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> customOptions</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> Request.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">Options</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">10</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">TimeUnit</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">SECONDS</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">20</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">TimeUnit</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">SECONDS</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#569CD6;--shiki-dark:#569CD6;">false</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> Feign</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">builder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">().</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">options</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(customOptions).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">client</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(client).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">requestInterceptor</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">headerInterceptor</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">()).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">contract</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(contract).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">encoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(encoder).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">decoder</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(decoder).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">logger</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#C586C0;--shiki-dark:#C586C0;">new</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> Slf4jLogger</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">()).</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">logLevel</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">Logger</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">Level</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">FULL</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">    /**</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     * 设置签名header</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     *</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     * </span><span style="color:#569CD6;--shiki-dark:#569CD6;">@return</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">     */</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Bean</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> RequestInterceptor</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> headerInterceptor</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">() {</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        return</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> requestTemplate </span><span style="color:#569CD6;--shiki-dark:#569CD6;">-&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">            Map</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">String</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">, </span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">String</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">&gt; </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">headers</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">RpcSignUtils</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">gererateSignHeaders</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(appKey, appSecret);</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">            headers</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">keySet</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">().</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">forEach</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(key </span><span style="color:#569CD6;--shiki-dark:#569CD6;">-&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">                requestTemplate</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">header</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(key, </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">headers</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">get</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(key));</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">            });</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">        };</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>userClientHost</code>：为配置文件中配置的对应服务地址，可以配置多个，不同服务<code>Client</code>使用对应配置即可</li><li><code>appKey、appSecret</code>：对应AK、SK</li><li><code>headerInterceptor</code>方法：设置请求头，具体情况具体实现</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">@</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Service</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">public</span><span style="color:#569CD6;--shiki-dark:#569CD6;"> class</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> ServiceImpl</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    @</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Autowired</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> UserClient</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> userClient</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    public</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> void</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> getUserById</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">Long</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> userId</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        User</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> user</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">userClient</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getUserById</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(userId);</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">        // ...</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用时注入对应<code>Client</code>即可</li></ul>`,8),r=[l];function e(p,o){return a(),n("div",null,r)}const c=s(D,[["render",e],["__file","ConfigurationFeignClient.html.vue"]]),d=JSON.parse('{"path":"/Use/Java/Feign/ConfigurationFeignClient.html","title":"一、配置FeignClient","lang":"zh-CN","frontmatter":{"category":["使用篇"],"tag":["配置FeignClient"]},"headers":[{"level":3,"title":"2、方式二","slug":"_2、方式二","link":"#_2、方式二","children":[]}],"git":{"createdTime":1710676914000,"updatedTime":1710676914000,"contributors":[{"name":"zhanglinwei","email":"3498729975@qq.com","commits":1}]},"readingTime":{"minutes":1.19,"words":357},"filePathRelative":"Use/Java/Feign/ConfigurationFeignClient.md","localizedDate":"2024年3月17日"}');export{c as comp,d as data};
