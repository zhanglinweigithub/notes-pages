import{_ as s,o as a,c as D,a as n}from"./app-Vg0IViah.js";const l={},i=n(`<h1 id="watch、watcheffect" tabindex="-1"><a class="header-anchor" href="#watch、watcheffect"><span>watch、watchEffect</span></a></h1><h2 id="一、watch" tabindex="-1"><a class="header-anchor" href="#一、watch"><span>一、watch</span></a></h2><p>与<code>Vue2.x</code>中<code>watch</code>配置功能一致</p><p>两个小“坑”：</p><ul><li>监视<code>reactive</code>定义的响应式数据时：<code>oldValue</code>无法正确获取、强制开启了深度监视（deep配置失效）。</li><li>监视<code>reactive</code>定义的响应式数据中某个属性时：<code>deep</code>配置有效</li></ul><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#808080;--shiki-dark:#808080;">&lt;</span><span style="color:#569CD6;--shiki-dark:#569CD6;">script</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> setup</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">//情况一：监视ref定义的响应式数据</span></span>
<span class="line"><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">watch</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">sum</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  console</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;sum变化了&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">},{</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">immediate:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">//情况二：监视多个ref定义的响应式数据</span></span>
<span class="line"><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">watch</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">([</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">sum</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">msg</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">],(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  console</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;sum或msg变化了&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">/* 情况三：监视reactive定义的响应式数据</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">			若watch监视的是reactive定义的响应式数据，则无法正确获得oldValue！！</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">			若watch监视的是reactive定义的响应式数据，则强制开启了深度监视 </span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">*/</span></span>
<span class="line"><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">watch</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">person</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  console</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;person变化了&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">},{</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">immediate:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">deep:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">false</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}) </span><span style="color:#6A9955;--shiki-dark:#6A9955;">//此处的deep配置不再奏效</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">//情况四：监视reactive定义的响应式数据中的某个属性</span></span>
<span class="line"><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">watch</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(()</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">person</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">job</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  console</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;person的job变化了&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">},{</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">immediate:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">deep:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">//情况五：监视reactive定义的响应式数据中的某些属性</span></span>
<span class="line"><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">watch</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">([()</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">person</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">job</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,()</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">person</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">name</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">],(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  console</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;person的job变化了&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">},{</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">immediate:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">deep:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">//特殊情况</span></span>
<span class="line"><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">watch</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(()</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">person</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">job</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,(</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">  console</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;person的job变化了&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">newValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">,</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">oldValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">},{</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">deep:</span><span style="color:#569CD6;--shiki-dark:#569CD6;">true</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}) </span><span style="color:#6A9955;--shiki-dark:#6A9955;">//此处由于监视的是reactive素定义的对象中的某个属性，所以deep配置有效</span></span>
<span class="line"><span style="color:#808080;--shiki-dark:#808080;">&lt;/</span><span style="color:#569CD6;--shiki-dark:#569CD6;">script</span><span style="color:#808080;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、watcheffect函数" tabindex="-1"><a class="header-anchor" href="#二、watcheffect函数"><span>二、watchEffect函数</span></a></h2><ul><li><code>watch</code>的套路是：既要指明监视的属性，也要指明监视的回调。</li><li><code>watchEffect</code>的套路是：不用指明监视哪个属性，监视的回调中用到哪个属性，那就监视哪个属性。</li><li><code>watchEffect</code>有点像<code>computed</code>： <ul><li>但<code>computed</code>注重的计算出来的值（回调函数的返回值），所以必须要写返回值。</li><li>而<code>watchEffect</code>更注重的是过程（回调函数的函数体），所以不用写返回值</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">// watchEffect所指定的回调中用到的数据只要发生变化，则直接重新执行回调。</span></span>
<span class="line"><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">watchEffect</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(()</span><span style="color:#569CD6;--shiki-dark:#569CD6;">=&gt;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    const</span><span style="color:#4FC1FF;--shiki-dark:#4FC1FF;"> x1</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">sum</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">value</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">    const</span><span style="color:#4FC1FF;--shiki-dark:#4FC1FF;"> x2</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">person</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">age</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">    console</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">log</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#CE9178;--shiki-dark:#CE9178;">&#39;watchEffect配置的回调执行了&#39;</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">})</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9),e=[i];function p(r,o){return a(),D("div",null,e)}const k=s(l,[["render",p],["__file","Watch-watchEffect.html.vue"]]),d=JSON.parse('{"path":"/Grammar/Font/Vue3/Watch-watchEffect.html","title":"watch、watchEffect","lang":"zh-CN","frontmatter":{"category":"语法"},"headers":[{"level":2,"title":"一、watch","slug":"一、watch","link":"#一、watch","children":[]},{"level":2,"title":"二、watchEffect函数","slug":"二、watcheffect函数","link":"#二、watcheffect函数","children":[]}],"git":{"createdTime":1708330205000,"updatedTime":1708873062000,"contributors":[{"name":"zhanglinwei","email":"3498729975@qq.com","commits":2}]},"readingTime":{"minutes":1.74,"words":522},"filePathRelative":"Grammar/Font/Vue3/Watch-watchEffect.md","localizedDate":"2024年2月19日"}');export{k as comp,d as data};
