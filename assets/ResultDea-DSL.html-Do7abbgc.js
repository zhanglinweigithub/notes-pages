import{_ as d}from"./image-20210721191544750-8RaW55Fg.js";import{_ as k,r as c,o as t,c as p,e as s,f as a,g as D,w as l,a as r}from"./app-Vg0IViah.js";const h="/notes-pages/assets/image-20210721203349633-BJPtKN2N.png",C={},y=s("h1",{id:"排序、分页、高亮、提分-dsl",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#排序、分页、高亮、提分-dsl"},[s("span",null,"排序、分页、高亮、提分-DSL")])],-1),u=s("h2",{id:"一、排序",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#一、排序"},[s("span",null,"一、排序")])],-1),E=s("code",null,"elasticsearch",-1),m={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/sort-search-results.html",target:"_blank",rel:"noopener noreferrer"},v=s("div",{class:"hint-container warning"},[s("p",{class:"hint-container-title"},"注意"),s("p",null,"一旦排序后，就不会进行相关性打分")],-1),b=s("h3",{id:"普通字段排序",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#普通字段排序"},[s("span",null,"普通字段排序")])],-1),F=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match_all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "sort"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"排序方式"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"  // 排序字段、排序方式ASC、DESC")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  ]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),A=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 酒店数据按照用户评价（score)降序排序，评价相同的按照价格(price)升序排序")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match_all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "sort"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "score"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"desc"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"  // 根据评价降序排序")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "price"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"asc"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"  // 根据价格升序排序")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  ]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),g=r('<div class="hint-container info"><p class="hint-container-title">相关信息</p><p>按照声明的顺序，当第一个条件相等时，再按照第二个条件排序，以此类推</p></div><h3 id="地理坐标排序" tabindex="-1"><a class="header-anchor" href="#地理坐标排序"><span>地理坐标排序</span></a></h3><ul><li>指定一个坐标，作为目标点</li><li>计算每一个文档中，指定字段（必须是geo_point类型）的坐标到目标点的距离是多少</li><li>根据距离排序</li></ul><h4 id="排序" tabindex="-1"><a class="header-anchor" href="#排序"><span>排序</span></a></h4>',4),_={class:"hint-container tip"},f=s("p",{class:"hint-container-title"},"提示",-1),x={href:"https://lbs.amap.com/demo/jsapi-v2/example/map/click-to-get-lnglat/",target:"_blank",rel:"noopener noreferrer"},j=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match_all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "sort"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "_geo_distance"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"纬度，经度"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 文档中geo_point类型的字段名、目标坐标点")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "order"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"asc"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 排序方式")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "unit"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"km"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 排序的距离单位")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  ]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),B=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match_all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "sort"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "_geo_distance"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "location"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"30.192303，120.189967"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",  "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 纬度，经度")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "order"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"asc"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 升序")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'          "unit"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}}," : "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"km"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 排序的距离单位")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  ]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),S=r(`<h4 id="显示距离" tabindex="-1"><a class="header-anchor" href="#显示距离"><span>显示距离</span></a></h4><p>具体<strong>距离</strong>值，这个值在响应结果中是独立的</p><p>因此，我们在结果解析阶段，除了解析<code>source</code>部分以外，还要得到<code>sort</code>部分，也就是排序的距离，然后放到响应结果中。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes dark-plus dark-plus" style="background-color:#1E1E1E;--shiki-dark-bg:#1E1E1E;color:#D4D4D4;--shiki-dark:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6;">private</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;"> void</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;"> handleResponse</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">SearchResponse</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> response) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">    SearchHits</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> searchHits</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">response</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getHits</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">    long</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> total</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">searchHits</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getTotalHits</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">().</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">value</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">    SearchHit</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">[] </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">hits</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">searchHits</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getHits</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">    for</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> (</span><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">SearchHit</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> hit</span><span style="color:#C586C0;--shiki-dark:#C586C0;"> :</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> hits) {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        String</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> json</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">hit</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getSourceAsString</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        UserDoc</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> userDoc</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">JSON</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">parseObject</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(json, </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">UserDoc</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">class</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">        </span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955;">        // 获取排序值</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">        Object</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">[] </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">sortValues</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = </span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">hit</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">getSortValues</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#C586C0;--shiki-dark:#C586C0;">        if</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> (</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">sortValues</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">length</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> &gt; </span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">0</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#4EC9B0;--shiki-dark:#4EC9B0;">            Object</span><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;"> sortValue</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;"> = sortValues[</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8;">0</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">];</span></span>
<span class="line"><span style="color:#9CDCFE;--shiki-dark:#9CDCFE;">            userDoc</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">.</span><span style="color:#DCDCAA;--shiki-dark:#DCDCAA;">setDistance</span><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">(sortValue); </span><span style="color:#6A9955;--shiki-dark:#6A9955;">// 距离字段</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、分页" tabindex="-1"><a class="header-anchor" href="#二、分页"><span>二、分页</span></a></h2><p>默认情况下只返回<code>top10</code>的数据</p>`,6),q=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match_all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "from"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"0"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 分页开始的位置，默认为0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "size"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"10"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 期望获取的文档总数，默认为10")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "sort"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    {"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'"price"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"asc"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  ]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),T=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match_all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "from"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"0"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 分页开始的位置，默认为0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "size"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"10"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 期望获取的文档总数，默认为10")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "sort"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    {"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'"price"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"asc"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  ]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),w=r('<h2 id="三、高亮" tabindex="-1"><a class="header-anchor" href="#三、高亮"><span>三、高亮</span></a></h2><div class="hint-container warning"><p class="hint-container-title">注意</p><ul><li><p><strong>高亮查询必须使用全文检索查询</strong>，并且要有搜索关键字，将来才可以对关键字高亮</p></li><li><p>默认情况下，<strong>高亮的字段，必须与搜索指定的字段一致</strong>，否则无法高亮</p></li><li><p>如果要对非搜索字段高亮，则需要添加一个属性：<code>required_field_match=false</code></p></li><li><p>高亮的结果与查询的文档结果默认是分离的，并不在一起。因此解析高亮的代码需要额外处理</p></li></ul></div>',2),G=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"关键字"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 查询条件，高亮一定要使用全文检索查询")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "highlight"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "fields"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 指定要高亮的字段")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "字段"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "pre_tags"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"<em>"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",  "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 用来标记高亮字段的前置标签")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "post_tags"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"</em>"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 用来标记高亮字段的后置标签")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),V=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"如家"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 查询条件，高亮一定要使用全文检索查询")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'  "highlight"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "fields"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 指定要高亮的字段")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'      "name"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "pre_tags"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"<em>"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},",  "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 用来标记高亮字段的前置标签")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "post_tags"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"</em>"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},", "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 用来标记高亮字段的后置标签")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "required_field_match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"false"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 对非搜索字段高亮")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),H=r('<figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>上面的搜索字段为 <code>all</code> ， 高亮字段为 <code>name</code> ，默认是无法高亮的，所以需添加<code>required_field_match=false</code></p></div><h2 id="四、提高打分" tabindex="-1"><a class="header-anchor" href="#四、提高打分"><span>四、提高打分</span></a></h2><p><code>function_score</code>查询可以影响算分</p><p>包含3个要素：</p><ul><li>过滤条件：哪些文档要加分</li><li>算分函数：如何计算<code>function score</code></li><li>加权方式：<code>function score</code> 与 <code>query score</code>如何运算</li></ul>',6),N=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /索引库/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'   "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'       "function_score"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'           "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'"match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {"),s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'"all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"外滩"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"} },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'           "functions"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"               {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                   "filter"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {"),s("span",{style:{color:"#F44747","--shiki-dark":"#F44747"}},"过滤条件"),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"},")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                   "算分函数"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#F44747","--shiki-dark":"#F44747"}},"值")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"               }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"           ],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'           "运算模式"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"multiply"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"       }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"   } ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),L=s("div",{class:"language-json line-numbers-mode","data-ext":"json","data-title":"json"},[s("pre",{class:"shiki shiki-themes dark-plus dark-plus",style:{"background-color":"#1E1E1E","--shiki-dark-bg":"#1E1E1E",color:"#D4D4D4","--shiki-dark":"#D4D4D4"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"GET /hotel/_search")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'    "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'        "function_score"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'            "query"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 原始查询，可以是任意条件")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                "match"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                    "all"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"外滩"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"            },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'            "functions"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": [ "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 算分函数")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                    "filter"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": { "),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}},"// 满足的条件，品牌必须是如家")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                        "term"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                            "brand"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"如家"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                        }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                    },")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'                    "weight"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#B5CEA8","--shiki-dark":"#B5CEA8"}},"2"),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 算分权重为2")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"                }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"            ],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9CDCFE","--shiki-dark":"#9CDCFE"}},'            "boost_mode"'),s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},": "),s("span",{style:{color:"#CE9178","--shiki-dark":"#CE9178"}},'"sum"'),s("span",{style:{color:"#6A9955","--shiki-dark":"#6A9955"}}," // 加权模式，求和")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"        }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D4D4D4","--shiki-dark":"#D4D4D4"}},"}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),z=r('<figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><strong>原始查询</strong>条件：基于这个条件搜索文档，并且基于<code>BM25</code>算法给文档打分，<strong>原始算分</strong>（query score)</li><li><strong>过滤条件</strong>：符合该条件的文档才会重新算分</li><li><strong>算分函数</strong> ：符合过滤条件的文档要根据这个函数做运算，得到函数算分（function score）</li><li>有四种函数 <ul><li><code>weight</code>：函数结果是常量</li><li><code>field_value_factor</code>：以文档中的某个字段值作为函数结果</li><li><code>random_score</code>：以随机数作为函数结果</li><li><code>script_score</code>：自定义算分函数算法</li></ul></li><li>运算模式：算分函数的结果、原始查询的相关性算分，两者之间的运算方式，包括： <ul><li><code>multiply</code>：相乘</li><li><code>replace</code>：用<code>function score</code>替换<code>query score</code></li><li>其它，例如：<code>sum、avg、max、min</code></li></ul></li></ul>',2);function R(J,O){const o=c("ExternalLinkIcon"),e=c("CodeTabs");return t(),p("div",null,[y,u,s("p",null,[E,a("默认是根据相关度算分（_score）来排序，但是也支持自定义方式对搜索"),s("a",m,[a("结果排序"),D(o)]),a("。")]),v,b,D(e,{id:"17",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[F]),tab1:l(({value:i,isActive:n})=>[A]),_:1}),g,s("div",_,[f,s("p",null,[a("获取你的位置的经纬度的方式："),s("a",x,[a("https://lbs.amap.com/demo/jsapi-v2/example/map/click-to-get-lnglat/"),D(o)])])]),D(e,{id:"58",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[j]),tab1:l(({value:i,isActive:n})=>[B]),_:1}),S,D(e,{id:"82",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[q]),tab1:l(({value:i,isActive:n})=>[T]),_:1}),w,D(e,{id:"117",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[G]),tab1:l(({value:i,isActive:n})=>[V]),_:1}),H,D(e,{id:"159",data:[{id:"语法"},{id:"示例"}]},{title0:l(({value:i,isActive:n})=>[a("语法")]),title1:l(({value:i,isActive:n})=>[a("示例")]),tab0:l(({value:i,isActive:n})=>[N]),tab1:l(({value:i,isActive:n})=>[L]),_:1}),z])}const P=k(C,[["render",R],["__file","ResultDea-DSL.html.vue"]]),K=JSON.parse('{"path":"/Use/Java/ElasticSearch/ResultDea-DSL.html","title":"排序、分页、高亮、提分-DSL","lang":"zh-CN","frontmatter":{"order":9,"category":"使用篇"},"headers":[{"level":2,"title":"一、排序","slug":"一、排序","link":"#一、排序","children":[{"level":3,"title":"普通字段排序","slug":"普通字段排序","link":"#普通字段排序","children":[]},{"level":3,"title":"地理坐标排序","slug":"地理坐标排序","link":"#地理坐标排序","children":[]}]},{"level":2,"title":"二、分页","slug":"二、分页","link":"#二、分页","children":[]},{"level":2,"title":"三、高亮","slug":"三、高亮","link":"#三、高亮","children":[]},{"level":2,"title":"四、提高打分","slug":"四、提高打分","link":"#四、提高打分","children":[]}],"git":{"createdTime":1708330205000,"updatedTime":1708873062000,"contributors":[{"name":"zhanglinwei","email":"3498729975@qq.com","commits":2}]},"readingTime":{"minutes":4.2,"words":1259},"filePathRelative":"Use/Java/ElasticSearch/ResultDea-DSL.md","localizedDate":"2024年2月19日"}');export{P as comp,K as data};
